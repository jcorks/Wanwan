<!DOCTYPE html>
<html lang="en-US">
<head></head><title>Test</title>
<meta charset="utf-8">
<link rel="icon" href="/favicon.ico" type="image/x-icon">

<meta name="viewport" content="width=device-width, initial-scale=.5">

<body onresize="manager.onresize()"
      style="background-color: #555 ;color: #CCC;">
    <div>
    <canvas id="canvas" width="400" height="400" style="background-color:rgb(64, 64, 64);" onresize="manager.onresize()"></canvas>
    <script type="text/javascript" src= "wanwan.min.js"></script>


    <!-- Define input regions for both the name and 
         message. The name precedes the message -->
    <div>
        <input type="text" id="nameEntry" 
            style="color: #DDD; background: rgb(100, 100, 100); 
                   border: none; width: 15%; outline: none;
                   font-family: monospace;
                   font-size: 15px;
                   float: left;
                   height:30px;
                   "
            value="Potato"></input>

        <input type="text" id="command" 
            style="color: #DDD; background: rgba(0, 0, 0, 1.0); 
                   border: none; width: 78%; outline: none;
                   font-family: monospace;
                   font-size: 15px;
                   float: left;
                   height:30px;

                   "
            onkeydown = "manager.input(event);"></input>
        </div>
    </div>



    <!-- Management setup.t -->
    <script>

        // when the page loads, initialize Wanwan
        window.onload = function(){
            Wanwan.Init("canvas", "http://localhost/bin/core.wanwan");
            Wanwan.Canvas.Font = "monospace";
            Wanwan.Canvas.FontSize = "12pt";
            manager.onresize();
        }


        var manager = {};
            manager.once = false;

        // Just resizes elements with the screen
        manager.onresize = function() { 
            var canvas = document.getElementById("canvas"); 
            if (!manager.once) {
                canvas.width  = window.innerWidth;
                canvas.height = (window.innerHeight - 70);
                manager.once = true;
            }
            document.getElementById("command").width = window.innerWidth*0.78;
            document.getElementById("nameEntry").width = window.innerWidth*0.15;

            // snce the canvas size probably cheanged, tell the canvas
            // to be redrawn
            Wanwan.Canvas.FullUpdate();
        }


        // send the mesage on enter
        manager.input = function(event) {
            if (event.keyCode == 13) {
                
                Wanwan.Name(textContent = document.getElementById("nameEntry").value); 
                textContent = document.getElementById("command").value; 
                document.getElementById("command").value = "";

                Wanwan.Post(textContent);
            }
        }

        // add whell control if available
        document.getElementById("canvas").addEventListener("wheel", function(event) {
            if (event.deltaY > 0) Wanwan.Canvas.VerticalScroll++;
            if (event.deltaY < 0) Wanwan.Canvas.VerticalScroll--;
            Wanwan.Canvas.FullUpdate();
            return false;
        }, false);


        

    </script>
</body>
